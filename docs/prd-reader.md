# 产品需求文档 (PRD) - 新闻笔记阅读详情页

接下来要开发的是系统中最为核心的一个页面功能，“新闻笔记阅读页的展示”，这个页面包含了新闻页的展示。同时可对新闻进行AI解读、内容批注、添加标签、设置分类、设置阅读器模式（字号、布局、主题色、字体等）、分享阅读、访问原始网页、快照、复制链接（复制原链接、复制Markdown链接）、复制内容（复制内容为文本、复制内容为Markdown、复制内容为HTML、复制快照为HTML）、导出（导出内容为TXT、导出内容为Markdown、导出内容为HTML、导出内容为PDF、导出快照为HTML）、设置为星标、移动、编辑信息（主要对标签、摘要、类别进行编辑）、归档、删除。

## 1. 页面概览与布局逻辑

* **页面定位：** 产品的核心生产力界面，集沉浸阅读、AI 辅助分析、深度笔记于一体的工作台。
* **布局架构：** 经典的 **三栏式布局 (3-Column Layout)**，响应式设计。
* **左侧 (15%-20%)：** 智能大纲导航 (Auto-Outline)。
* **中间 (50%-60%)：** 核心阅读区 (Reader View)。
* **右侧 (25%-30%)：** 智库面板 (AI & Annotations)。


* **全局状态：** 支持 **全屏禅模式 (Zen Mode)**，一键收起左右侧栏。

---

## 2. 顶部导航栏 (Header)

### 2.1. 顶部中间：视图切换 (View Switcher)

采用 Segment Control（分段控制器）样式，支持快捷键切换。

1. **沉浸阅读 (Article View)：** *默认选中*。经过清洗的纯净阅读模式，去除广告和无关侧边栏。
2. **原始网页 (Web View)：** 在 iframe 中加载原始 URL，保留网站原始排版。
3. **新闻快照 (Snapshot / AI Brief)：**
* **定义：** AI 生成的“简讯快照”。
* **展示：** 极简排版，展示核心事实 (Key Facts)、人物、时间、地点、事件结果。一张“文字照片”。



### 2.2. 顶部右侧：工具栏 (Toolbar)

以 Icon 形式展示，Hover 显示文字提示。

#### A. 阅读器样式 (Reader Appearance)

* **字号调整：** `A-` (减小) / `A+` (增大)，支持 5-7 档调节。
* **布局调整：**
* **页边距 (Margins)：** 调整左右间距（窄、标准、宽）。
* **行高 (Line Height)：** 紧凑、舒适、宽松。


* **主题色 (Theme)：**
* **浅色 (Light)** / **深色 (Dark)** / **护眼 (Sepia)** / **跟随系统**。


* **字体 (Font Family)：** 系统默认、衬线体 (Songti/Serif)、无衬线体 (Sans-serif)、等宽字体 (Mono)。

#### B. 更多操作 (More Actions)

下拉菜单包含以下功能：

* **分享阅读：** 生成分享卡片或公开链接。
* **访问原始网页：** 跳转浏览器打开。
* **更新/保存快照：** 手动触发网页存档或更新 AI 快照。
* **复制链接：** `复制原链接`、`复制 Markdown 链接`。
* **复制内容：**
* `复制纯文本` (Plain Text)
* `复制 Markdown` (保留格式)
* `复制 HTML`
* `复制快照 HTML` (带样式的卡片代码)
* **[新增] 复制为引用** (Copy as Citation: "> 选文 + 来源 + 链接")


* **导出：** `TXT`、`Markdown`、`HTML`、`PDF` (打印样式优化)、`导出快照图片/HTML`。
* **整理：**
* `设为星标` (Toggle Star)
* `移动文件夹` (Move Category)
* `编辑元信息` (Edit Meta)：弹窗修改标题、摘要、标签 (Tags)、原始发布时间。
* `归档` (Archive)
* `删除` (Delete)



#### C. AI 解读 (AI Analysis)

* **交互：** 点击后右侧面板自动切换至“AI 解读”标签页，并触发流式生成。
* **状态：** 生成中显示 Loading 动画，生成完展示结果。

#### D. 批注 (Annotations)

* **交互：** 点击后右侧面板切换至“批注列表”标签页。
* **提示：** 按钮角标显示当前文章的批注总数。

---

## 3. 中间区域：核心阅读区 (Main Content)

### 3.1. 元信息头 (Meta Header)

位于正文最上方。

* **标题：** 大字号展示。
* **来源信息：** 来源媒体图标 + 媒体名称 + 作者名。
* **时间与标签：** `发布时间` | `抓取时间` | `标签展示区(支持点击添加)`。
* **阅读预估：** “约 X 分钟读完”。

### 3.2. 正文交互 (Content Interaction)

* **划词菜单 (Selection Context Menu)：** *[核心交互]*
* 当用户选中一段文字时，鼠标附近立即悬浮微型工具条：
* **高亮色块：** 红 / 黄 / 绿 / 蓝 / 紫（默认选中上一次使用的颜色）。
* **写批注 (Pen Icon)：** 点击后右侧面板展开并聚焦输入框。
* **AI 解释 (Magic Icon)：** “解释这段话”。
* **复制 (Copy Icon)：** 仅复制选中文本。


* **图片查看 (Lightbox)：** 点击正文图片，全屏查看，支持旋转、下载、`以图搜图`。
* **代码块：** 如果内容包含代码，显示代码高亮及“复制”按钮。

---

## 4. 左侧区域：智能导航 (Left Sidebar)

* **自动大纲 (Auto TOC)：**
* 提取文章的 H1/H2/H3 标签生成目录。
* 若无标签，**AI 自动提炼** 关键段落的小标题作为锚点。


* **交互：**
* 点击锚点，正文平滑滚动至对应位置。
* **阅读进度联动：** 滚动正文时，左侧对应的目录项高亮。
* **自动隐藏：** 极短文章自动隐藏此栏，通过 CSS 居中正文。



---

## 5. 右侧区域：智库面板 (Right Sidebar)

面板包含两个顶部 Tab：**[ AI 解读 ]** 和 **[ 批注 ]**。

### 5.1. Tab A: AI 解读 (AI Analysis)

* **多视角解读 (Dropdown)：**
* `摘要模式` (默认)：TL;DR。
* `记者视点`：分析消息源、偏见、利益方。
* `金句提取`：提取 Quotes。
* `时间线`：梳理事件脉络。


* **内容展示区：** Markdown 渲染的 AI 生成内容。
* **追问输入框：** 底部提供 Input，允许对文章内容进行 AI 追问 (Chat with Article)。

### 5.2. Tab B: 批注列表 (Annotations) —— *[核心功能]*

按在文中出现的位置顺序排列卡片。

#### 批注卡片 (Note Card) 结构：

1. **原文引用 (Quote)：**
* 展示被高亮的文字。
* 左侧边缘带有对应颜色的竖线 (Color Indicator)。
* **点击交互：** 点击卡片，左侧正文自动滚动到该段落位置并闪烁。


2. **笔记内容 (User Note)：**
* 用户输入的批注文本。
* 支持空内容（仅高亮）。


3. **底部操作栏 (Action Bar)：**
* **改色：** 更改高亮背景色。
* **复制：** 复制“引用+笔记”。
* **删除：** 删除此条批注。
* **浮顶 (Float/Pin)：** *[特色功能]*



#### 特色功能：浮顶 (Floating Sticky Note)

* **触发：** 点击卡片上的“图钉图标”。
* **表现：**
1. 该批注卡片从右侧列表**脱离**。
2. 变为一个**半透明悬浮窗**，置于页面最上层 (Z-Index 最高)。
3. **可拖拽：** 用户可将其拖动到屏幕任意位置（如拖到正文旁对比阅读）。
4. **全局驻留（可选）：** 即使切换左侧目录章节，悬浮卡片依然存在。


* **归位：** 点击悬浮窗上的“取消浮顶”或“关闭”，卡片飞回右侧列表原位。

---

## 6. 其他细节补充

* **双向联动 (Bi-directional Linking)：**
* 点击右侧批注 -> 正文跳转。
* 点击正文高亮区域 -> 右侧面板自动滚动到对应卡片，并呈“选中状态”。


* **未保存提醒：** 如果正在编辑批注信息，用户试图关闭页面，弹出 Alert 提示。
* **加载状态：** 骨架屏 (Skeleton Screen) 优化加载体验。