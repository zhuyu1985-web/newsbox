接下来要开发的是系统中最为核心的一个页面功能，“新闻笔记阅读页的展示”，这个页面包含了新闻页的展示。同时可对新闻进行AI解读、内容批注、添加标签、设置分类、设置阅读器模式（字号、布局、主题色、字体等）、分享阅读、访问原始网页、快照、复制链接（复制原链接、复制Markdown链接）、复制内容（复制内容为文本、复制内容为Markdown、复制内容为HTML、复制快照为HTML）、导出（导出内容为TXT、导出内容为Markdown、导出内容为HTML、导出内容为PDF、导出快照为HTML）、设置为星标、移动、编辑信息（主要对标签、摘要、类别进行编辑）、归档、删除。

------

# 产品需求文档 (PRD)：自适应新闻笔记阅读详情页

## 1. 概述与核心理念

- **页面定位：** 产品的核心生产力界面，集沉浸阅读、视听分析、AI 辅助、深度笔记于一体的“第二大脑”工作台。
- **核心理念：**
  - **多态路由 (Polymorphic Routing)：** 自动判断内容类型，加载不同的渲染器。
  - **全媒体生产力：** “把视频当做文本来读”（ASR + 章节），“把图文当做数据来查”（AI 提炼 + 溯源），当成音频来听（自由选择多种表达形式）。
  - **记者工学：** 强调引用规范、证据留存（快照）、双向联动和多任务对比（悬浮批注）。
- **布局架构：** 响应式 **三栏式布局 (3-Column Layout)**，支持 **全屏禅模式 (Zen Mode)**（一键收起左右侧栏）。

------

## 2. 核心逻辑：内容类型路由 (Content Router)

页面加载时，系统读取笔记元数据，决定渲染模式：

- **模式 A：图文阅读模式 (Text Mode)**
  - **触发条件：** `type = article`。
  - **特征：** 强调排版、文字高亮、文档大纲。
- **模式 B：视听分析模式 (Video/Audio Mode)**
  - **触发条件：** `type = video`（来源为抖音、B站、YouTube 或包含主视频流）。
  - **特征：** 强调播放控制、ASR 听记、时间戳锚点。

------

## 3. 全局顶部导航栏 (Global Header)

无论何种模式，顶部保持结构一致，仅功能微调。

### 3.1 左侧：导航与路径

- **返回按钮** & **面包屑导航**（分类路径）。
- **阅读进度条：** 在顶部边缘设置极细进度条，可视化展示阅读/播放进度。

### 3.2 中间：视图切换 (View Switcher)

采用分段控制器 (Segment Control)：

1. **沉浸阅读 (Reader/Player)：** *默认*。清洗后的纯净正文或智能播放器。
2. **原始网页 (Web View)：** iframe 加载原始 URL，保留原站排版。
3. **AI 速览 (AI Brief)：** *[原“快照”重命名]* AI 生成的结构化事实卡片（核心事实、人物、结果），极简排版。
4. **网页存档 (Web Archive)：** *[新增]* 永久保存的网页快照（HTML/图片），用于证据留存，防止原链接失效。

### 3.3 右侧：工具箱 (Toolbar)

#### A. 阅读器样式 (Appearance) - *自适应*

- **图文模式：** 字号 (`A-`/`A+`)、页边距、行高、主题色（亮/暗/护眼/跟随）、字体（衬线/无衬线/系统）。
- **视频模式：** 字幕大小、字幕背景透明度、播放器背景填充（黑边 vs 高斯模糊）。

#### B. 更多操作 (Actions)

- **分享：** 生成卡片或公开链接。
- **访问原网页：** 跳转浏览器。
- **复制链接：** `复制原链接`、`复制 Markdown 链接`。
- **复制内容：**
  - `复制纯文本` / `复制 Markdown` / `复制 HTML`。
  - **复制为引用 (Copy as Citation)：** *[核心]* 格式：`> 选中文本 [链接](URL) (访问于 日期)`。
  - `复制为 ASR 逐字稿` (视频模式特有)。
- **导出：**
  - `PDF` (打印优化)、`Markdown`、`TXT`。
  - `SRT 字幕` (视频模式特有)、`视频关键帧打包`。
  - `导出网页存档 HTML` (证据留存)。
- **整理：**
  - `设为星标`、`移动文件夹`、`编辑元信息` (标题/标签/摘要)。
  - `归档` / `稍后读`：读了一半退出自动记录进度；读完手动归档。

#### C. AI 阅读 (AI Analysis)

- **交互：** 点击后**展开右侧面板**并选中 **[AI 解读]** Tab。
- **状态：** 若尚未生成，点击触发流式生成；若已生成，直接展示。
- **视觉：** 建议使用“魔法棒”或“芯片”图标。

#### D. 内容批注 (Annotation)

- **交互：** 点击后**展开右侧面板**并选中 **[批注列表]** Tab。
- **状态：** 按钮右上角需展示 **数字角标 (Badge)**，显示当前文章的批注总数。
- **视觉：** 建议使用“笔记”或“高亮笔”图标。

------

## 4. 中间区域：自适应核心舞台 (Main Stage)

### 场景 A：图文模式 (Text Mode)

#### 1. 元信息头 (Meta Header)

- **基础信息：** 标题、来源媒体 (Icon+名称)、作者。
- **时效性信息：** **发布时间** + **抓取时间** (记者刚需，区分时效)。
- **标签区：** 展示并支持快速增删标签。
- **阅读预估：** “约 X 分钟读完”。

#### 2. 正文交互

- **纯净渲染：** 去除广告侧边栏，保留代码块高亮。
- **多媒体增强：**
  - **Lightbox：** 图片点击放大、旋转、下载。
  - **图注保留：** AI 解析时不丢失图片下方的说明文字。
- **划词气泡菜单 (Pop-over Menu)：** *[高频交互]*
  - 选中文字后立即悬浮：`[高亮色块]`、`[写批注]`、`[AI 解释]`、`[搜索]`、`[复制]`。

### 场景 B：视频模式 (Video Mode)

#### 1. 智能播放器容器

- **自适应画幅：**
  - **横屏 (16:9)：** 居中，黑色背景。
  - **竖屏 (9:16)：** 居中，两侧**高斯模糊填充**，适应桌面端阅读。
- **控制增强：**
  - **倍速：** 0.5x - 3.0x。
  - **循环区间 (Loop)：** 框选进度条（如 00:15-00:25）反复播放（听写校对用）。
  - **一键截帧：** 点击相机图标 -> 截图并保存到右侧批注栏（带时间戳）。
  - **画中画 (PiP)：** 边看视频边滚动画布。
  - **静音阅读模式：** 默认静音，完全依赖右侧高亮字幕阅读。

------

## 5. 左侧区域：智能导航 (Left Sidebar)

### 图文模式：智能大纲 (Auto-Outline)

- 提取 H1-H3 标签。若无标签，**AI 自动提炼**关键段落小标题作为锚点。
- **交互：** 点击跳转，滚动时高亮当前章节。短文章自动隐藏。

### 视频模式：智能章节 (Smart Chapters)

- **AI 自动分段：** 基于语义或画面转场切分（如 `00:00 导语` -> `01:30 现场采访`）。
- **交互：** 点击章节 -> 视频跳转 + 右侧逐字稿跳转。

------

## 6. 右侧区域：智库面板 (Right Sidebar)

面板支持 **Split View (分屏)** 或 **Tabs (标签页)** 切换。

### 6.1 通用模块：批注列表 (Annotations) —— *核心功能*

- **卡片结构：**
  - **引用 (Quote)：** 图文显示被划线文字；视频显示**截帧图片**或**台词**。
  - **笔记 (Note)：** 用户输入内容。
  - **锚点：**
    - 图文：点击卡片 -> 正文滚动并闪烁。
    - 视频：点击卡片 -> **视频跳转到对应秒数 (Timecode)**。
- **操作：** 改色、复制、删除。
- **特色功能：浮顶 (Floating Sticky Note)**
  - **触发：** 点击“图钉”图标。
  - **效果：** 卡片脱离列表，变为**全局悬浮窗**。
  - **价值：** 跨文章漫游时依然可见（便于跨多篇报道写稿对比）。

### 6.2 通用模块：AI 解读 (AI Analysis)

- **多视角分析：**
  - `摘要` (TL;DR)。
  - `记者视点` (分析消息源可靠性、利益相关方)。
  - `时间线` (梳理事件脉络)。
  - `视频特有`：**视觉摘要** (识别关键画面如“火灾现场”)、**Deepfake 预警** (提示 AI 生成痕迹)。
- **AI 追问 (Chat)：** 底部输入框，RAG 问答 (如“这篇文章对房地产有何利空？”)。

### 6.3 视频特有模块：听记 (Transcript)

- **ASR 逐字稿：** 显示全视频文本。
- **说话人识别 (Diarization)：** 自动区分“主持人”、“嘉宾”，支持手动重命名。
- **卡拉OK式高亮：** 视频播放时，文字逐词高亮滚动。
- **双向交互：** 点击文字 -> 视频跳转。
- **校对模式：** 允许用户直接修改识别错误的文字，修正后用于导出 SRT。

------

## 7. 边缘情况与特殊处理 (Edge Cases)

- **混合内容 (Embedded Video)：**
  - 图文新闻中嵌入了视频（如公众号内嵌视频）。
  - **策略：** 默认走图文模式。播放器旁提供按钮 **“提取为视频笔记”**，点击后将视频单独提取，进入视频模式深度分析。
- **未保存保护：** 编辑批注时关闭页面，弹出 Alert。
- **原始链接失效：** 提示用户查看“网页存档 (Web Archive)”。
- **引用格式化：** 无论在哪里复制，都提供“复制为引用格式”选项，确保新闻伦理规范。