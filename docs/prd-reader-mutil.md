明白，这是一个非常关键的逻辑梳理。这意味着这个页面是一个**“多态页面” (Polymorphic Page)**。

它需要根据新闻笔记的**元数据类型（Content Type）**，自动判断并加载两套完全不同的**“中间内容渲染器”**和**“右侧面板组件”**，但保持统一的全局操作体验（如归档、星标、标签管理）。

以下是整合后的**“自适应新闻笔记详情页”**功能描述清单。我着重描述了**判断逻辑**和**不同模式下的差异化展示**。

---

# 核心功能描述：自适应新闻笔记详情页 (Adaptive News Detail Page)

## 1. 核心逻辑：内容类型路由 (Content Router)

页面加载时，系统读取笔记的元数据字段 `type`，自动决定渲染模式：

* **判定逻辑 A（图文模式）：** 若 `type = text/html` 或 `article`。
* **激活视图：** 沉浸式阅读器布局。
* **核心特征：** 强调排版、文字高亮、目录大纲。


* **判定逻辑 B（视频模式）：** 若 `type = video`（来源为抖音、B站、YouTube等或包含主视频流）。
* **激活视图：** 影院/播放器布局。
* **核心特征：** 强调播放控制、ASR 听记、时间戳批注。



---

## 2. 顶部导航栏 (Header) - **[全局通用]**

无论图文还是视频，顶部功能保持高度一致，仅在“阅读设置”中做微调。

* **左侧：** 返回按钮、面包屑导航（分类路径）。
* **中间：** 视图切换 Tab
* `[ 原文 ]` (根据模式不同，展示正文或视频)
* `[ 原网页 ]` (iframe 嵌入原始 URL)
* `[ AI 快照 ]` (结构化核心事实卡片)


* **右侧：**
* **阅读器样式 (Style)：**
* *图文模式下：* 调节字号、行高、背景色、字体。
* *视频模式下：* **调节字幕大小、字幕背景透明度、播放器背景填充模式**（黑边/模糊）。


* **更多操作 (Actions)：** 分享、复制链接、导出（根据模式动态变化选项）、归档、删除。
* **AI 解读 & 批注开关：** 控制右侧面板显隐。



---

## 3. 中间区域：核心展示 (Adaptive Main Stage)

这里是差异化最大的区域。

### 场景 A：图文新闻 (Text Mode)

* **布局：** 经典的文档阅读流。
* **左侧侧边栏：** **[智能大纲]**（H1/H2 标题导航）。
* **中间内容：**
* **纯净排版：** 去除干扰元素，仅保留图文。
* **交互：** 支持文本划词高亮、划词评注、图片点击放大。
* **代码/表格：** 特殊渲染优化，支持代码一键复制。



### 场景 B：视频新闻 (Video Mode)

* **布局：** 播放器聚焦视图。
* **左侧侧边栏：** **[视频章节]**（Timeline Chapters）。
* AI 自动识别内容的转折点（如“00:00 开场”、“02:15 专家采访”），点击即跳转。


* **中间内容：**
* **智能播放器：**
* **适配：** 自动识别 16:9（横屏）或 9:16（竖屏抖音风），竖屏时两侧使用高斯模糊填充，防止黑边突兀。
* **控制条：** 倍速 (0.5x-3.0x)、**CC 字幕开关**、画中画、循环播放选段。
* **一键截帧：** 播放器右下角“相机”图标，点击将当前画面截图并保存到右侧批注栏。





---

## 4. 右侧区域：智库面板 (Adaptive Sidebar)

右侧面板根据内容类型，动态加载不同的 Tab 组合。

### 通用模块

* **批注 (Annotations)：** 无论是文字划线还是视频截帧，都汇聚在这里。
* **AI 追问 (Chat)：** 底部输入框，支持针对当前内容的问答。

### 差异化模块

| 功能模块 | **图文模式 (Text Mode)** | **视频模式 (Video Mode)** |
| --- | --- | --- |
| **Tab 1: AI 解读** | **文本分析：**<br>

<br>• 摘要/大意<br>

<br>• 关键金句提取<br>

<br>• 写作风格分析 | **多模态分析：**<br>

<br>• 视觉摘要（关键画面描述）<br>

<br>• 语音内容概括<br>

<br>• **说话人识别**（区分角色） |
| **Tab 2: 批注列表** | **文本锚点：**<br>

<br>• 点击批注，正文滚动到对应段落。<br>

<br>• 显示被划线的原文。 | **时间锚点：**<br>

<br>• 点击批注，**视频跳转到对应秒数**。<br>

<br>• 显示截帧图片或对应台词。 |
| **Tab 3: 听记 (New)** | *(不显示，或显示为“朗读原文”)* | **ASR 逐字稿 (Transcript)：**<br>

<br>• 音文同步高亮（卡拉OK效果）。<br>

<br>• 点击文字跳转播放。<br>

<br>• 支持在逐字稿上划词批注。 |

---

## 5. 核心交互差异点 (Interaction Details)

为了确保开发人员理解细节，需明确以下差异：

### 5.1 复制与导出 (Copy & Export)

* **图文模式：**
* `复制 Markdown`：复制正文文本及格式。
* `导出 PDF`：导出类似报纸排版的文档。


* **视频模式：**
* `复制内容`：复制的是 **ASR 逐字稿文本**。
* `复制 Markdown`：复制“逐字稿 + 时间戳”格式（例如：`[00:15] 这是一个重要观点`）。
* `导出 SRT`：导出标准字幕文件。
* `导出视频快照`：打包导出所有截帧图片。



### 5.2 批注的触发方式 (Annotation Trigger)

* **图文模式：** 鼠标**选中文字** -> 弹出气泡菜单 -> 点击“批注”。
* **视频模式：**
* 方式一：在右侧 **[听记]** 面板中**选中文字** -> 弹出气泡菜单 -> 点击“批注”（关联时间戳）。
* 方式二：在播放器点击 **[截帧/批注]** 按钮 -> 暂停视频 -> 弹出批注输入框（关联当前画面帧）。



---

## 6. 混合内容的特殊处理 (Edge Cases)

**场景：** 一篇图文新闻中嵌入了一个视频（例如公众号文章里插了一个视频）。

* **处理策略：** 默认采用 **“图文模式”**。
* **增强体验：**
* 文中嵌入的视频播放器，支持 **“提取为视频笔记”** 按钮。
* 点击后，系统将该视频提取出来，创建一个新的“视频类型”笔记，或切换到“视频模式”视图进行深度分析。



---

### 总结给开发团队的提示

在开发“详情页组件”时，请设计一个 **父容器 (Smart Container)**，它接收数据后：

1. 检查 `media_type`。
2. `v-if="type === 'video'"`：渲染 `<VideoPlayerContext>`（加载播放器核心、Timeline组件、ASR服务）。
3. `v-else`：渲染 `<ArticleReaderContext>`（加载排版引擎、DOM高亮服务）。
4. 右侧面板通过 `props` 接收同样的数据，动态渲染对应的 Tab 内容。